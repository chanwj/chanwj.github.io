((root,factory)=>{'function'==typeof define&&define.amd?define([],factory()):'object'==typeof exports?module.exports=factory():root.DarkMode=factory()})(this,function(pluginName){function normalizeTime(time){var date=new Date,time=time.split(':');return date.setHours(time[0],time[1],0,0)}var defaults={light:!1,dark:!1,startAt:'21:00',endAt:'06:00',checkSystemScheme:!0,saveOnToggle:!0},Head=document.getElementsByTagName('head')[0],Body=document.getElementsByTagName('body')[0];function Plugin(options){this.options=(options=>{var prop,extended={};for(prop in defaults)Object.prototype.hasOwnProperty.call(defaults,prop)&&(extended[prop]=defaults[prop]);for(prop in options)Object.prototype.hasOwnProperty.call(options,prop)&&(extended[prop]=options[prop]);return extended})(options),this.init()}return Plugin.prototype={init:function(){function setSystemScheme(mode){window.matchMedia('(prefers-color-scheme: '+mode+')').addListener(function(e){return e.matches&&plugin.setMode(mode)})}var plugin;return this.options.saveOnToggle||localStorage.removeItem('dm-mode'),window.matchMedia&&this.options.checkSystemScheme&&(plugin=this,setSystemScheme('light'),setSystemScheme('dark')),this.setMode(this.getMode())},getMode:function(){var startAt,endAt,now;return this.mode||localStorage.getItem('dm-mode')||(window.matchMedia&&this.options.checkSystemScheme?this.getSystemScheme():(startAt=normalizeTime(this.options.startAt),(endAt=normalizeTime(this.options.endAt))<(now=(new Date).getTime())&&startAt<now||now<startAt&&now<endAt?'dark':'light'))},setMode:function(enabledMode,ifToggle){var darkStyles,type,stylesheet;return'light'!==enabledMode&&'dark'!==enabledMode?(console.error('setMode','Invalid value'),!1):('dark'==(this.mode=enabledMode)?((darkStyles=document.getElementById('dm-dark'))?darkStyles.removeAttribute('disabled'):(type='dm-dark',enabledMode=this.options[enabledMode],(stylesheet=document.createElement('link')).id=type,stylesheet.rel='stylesheet',stylesheet.type='text/css',stylesheet.href=enabledMode,Head.appendChild(stylesheet)),Body.classList.add('dm-dark')):((darkStyles=document.getElementById('dm-dark'))&&darkStyles.setAttribute('disabled',!0),Body.classList.remove('dm-dark')),!0)},isModeSaved:function(){return Boolean(localStorage.getItem('dm-mode'))},clearSavedMode:function(){return localStorage.removeItem('dm-mode'),this.mode=null,this.setMode(this.getMode()),!0},toggleMode:function(){var newMode='light'===this.mode?'dark':'light';return this.setMode(newMode,!0),this.options.saveOnToggle&&localStorage.setItem('dm-mode',newMode),newMode},getSystemScheme:function(){return window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light'}},Plugin});